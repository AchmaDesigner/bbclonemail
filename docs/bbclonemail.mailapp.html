<!DOCTYPE html>  <html> <head>   <title>bbclonemail.mailapp.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="bbclonemail.appselection.html">                 bbclonemail.appselection.js               </a>                                           <a class="source" href="bbclonemail.contactsapp.html">                 bbclonemail.contactsapp.js               </a>                                           <a class="source" href="bbclonemail.html">                 bbclonemail.js               </a>                                           <a class="source" href="bbclonemail.mailapp.categories.html">                 bbclonemail.mailapp.categories.js               </a>                                           <a class="source" href="bbclonemail.mailapp.html">                 bbclonemail.mailapp.js               </a>                                           <a class="source" href="bbclonemail.mailapp.mailbox.html">                 bbclonemail.mailapp.mailbox.js               </a>                                           <a class="source" href="bbclonemail.router.html">                 bbclonemail.router.js               </a>                                           <a class="source" href="bbclonemail.views.html">                 bbclonemail.views.js               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               bbclonemail.mailapp.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <p>Backbone.BBCloneMail
A reference application for Backbone.Marionette</p>

<p>Copyright (C)2011 Derick Bailey, Muted Solutions, LLC
Distributed Under MIT License</p>

<p>Documentation and Full License Available at:
http://github.com/derickbailey/backbone.bbclonemail
http://github.com/derickbailey/backbone.marionette</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <h2>MailApp</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>This is the app controller or sub-application
for email. It contains all of the 
high level knowledge of how to run the app
when it's in mail mode.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">BBCloneMail</span><span class="p">.</span><span class="nx">MailApp</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">BBCloneMail</span><span class="p">,</span> <span class="nx">Backbone</span><span class="p">){</span>
  <span class="kd">var</span> <span class="nx">MailApp</span> <span class="o">=</span> <span class="p">{};</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Email model and collection. These are pretty much
self explanatory.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">MailApp</span><span class="p">.</span><span class="nx">Email</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Model</span><span class="p">.</span><span class="nx">extend</span><span class="p">({});</span>

  <span class="nx">MailApp</span><span class="p">.</span><span class="nx">EmailCollection</span> <span class="o">=</span> <span class="nx">Backbone</span><span class="p">.</span><span class="nx">Collection</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">model</span><span class="o">:</span> <span class="nx">MailApp</span><span class="p">.</span><span class="nx">Email</span>
  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>This method instantiates the mailbox view and populates
it with the specified mail list. Then it passes that
view instance to the mainRegion to show it on the screen.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">displayEmailList</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">emailList</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">mailBox</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BBCloneMail</span><span class="p">.</span><span class="nx">MailApp</span><span class="p">.</span><span class="nx">MailBox</span><span class="p">({</span>
      <span class="nx">collection</span><span class="o">:</span> <span class="nx">emailList</span>
    <span class="p">})</span>
    <span class="nx">BBCloneMail</span><span class="p">.</span><span class="nx">mainRegion</span><span class="p">.</span><span class="nx">show</span><span class="p">(</span><span class="nx">mailBox</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="kd">var</span> <span class="nx">showFilteredEmailList</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">category</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">filteredMail</span> <span class="o">=</span> <span class="nx">MailApp</span><span class="p">.</span><span class="nx">emailList</span><span class="p">;</span>
   </pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Filter the mail by the category, if one was specified</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="nx">category</span><span class="p">){</span>
      <span class="nx">filteredMail</span> <span class="o">=</span> <span class="nx">filteredMail</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">email</span><span class="p">){</span>
        <span class="kd">var</span> <span class="nx">categories</span> <span class="o">=</span> <span class="nx">email</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">&quot;categories&quot;</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">found</span> <span class="o">=</span> <span class="nx">categories</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">category</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">return</span> <span class="nx">found</span><span class="p">;</span>
      <span class="p">});</span>
      <span class="nx">filteredMail</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MailApp</span><span class="p">.</span><span class="nx">EmailCollection</span><span class="p">(</span><span class="nx">filteredMail</span><span class="p">);</span>
    <span class="p">}</span>
    </pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>display the filtered email list</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">displayEmailList</span><span class="p">(</span><span class="nx">filteredMail</span><span class="p">);</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>Display the correct route, including the
optional category that is being shown</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">showRoute</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">category</span><span class="p">){</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>This is a "MailApp" method that is called whenever
we are switching the BBMailCone app into mail mode.
It replaces all of the visual regions with the 
correct content by calling the <code>show</code> method for the
correct region manager.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">MailApp</span><span class="p">.</span><span class="nx">show</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">category</span><span class="p">){</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>Show the mail box with email entries</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">showFilteredEmailList</span><span class="p">(</span><span class="nx">category</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>Show the mail categories list</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">BBCloneMail</span><span class="p">.</span><span class="nx">navigationRegion</span><span class="p">.</span><span class="nx">show</span><span class="p">(</span><span class="k">new</span> <span class="nx">BBCloneMail</span><span class="p">.</span><span class="nx">MailApp</span><span class="p">.</span><span class="nx">Categories</span><span class="p">.</span><span class="nx">CategoriesView</span><span class="p">({</span>
      <span class="nx">collection</span><span class="o">:</span> <span class="nx">MailApp</span><span class="p">.</span><span class="nx">Categories</span><span class="p">.</span><span class="nx">categoryCollection</span>
    <span class="p">}));</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>Let other parts of the app know that the mail app is now
being displayed.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">BBCloneMail</span><span class="p">.</span><span class="nx">vent</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">&quot;mail:show&quot;</span><span class="p">,</span> <span class="nx">category</span><span class="p">);</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>Listen to the click of the mail categories from the left hand
side of the mail app. When one is clicked, filter the mail that
we have down in to that category, and then display the filtered
list on the screen.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">BBCloneMail</span><span class="p">.</span><span class="nx">vent</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s2">&quot;mail:category:selected&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">category</span><span class="p">){</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>Show the mail box with email entries</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">showFilteredEmailList</span><span class="p">(</span><span class="nx">category</span><span class="p">);</span>
  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>Initializes the email collection object with the list
of emails that are passed in from the call to 
<code>BBCloneMail.start</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">BBCloneMail</span><span class="p">.</span><span class="nx">addInitializer</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">options</span><span class="p">){</span>
    <span class="nx">MailApp</span><span class="p">.</span><span class="nx">emailList</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MailApp</span><span class="p">.</span><span class="nx">EmailCollection</span><span class="p">(</span><span class="nx">options</span><span class="p">.</span><span class="nx">email</span><span class="p">);</span>
  <span class="p">});</span>
  
  <span class="k">return</span> <span class="nx">MailApp</span><span class="p">;</span>
<span class="p">})(</span><span class="nx">BBCloneMail</span><span class="p">,</span> <span class="nx">Backbone</span><span class="p">);</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 